# Base Workflow Template
# 
# This template provides the common structure shared by all workflow specs.
# New specs can reference this as a foundation and override specific sections.
#
# Usage: Copy this file and customise the [workflow], [phases], and prompt sections.

# =============================================================================
# METADATA
# =============================================================================

[meta]
version = "1.0.0"
schema = "lia-workflow-spec/v1"
# Override these in your spec:
# name = "your-workflow-name"
# category = "development|quality|problem-solving|research|knowledge|strategy"
# tags = ["tag1", "tag2"]

# =============================================================================
# CONFIGURATION
# =============================================================================

[config]
# Output directory pattern - use {task_name} as placeholder
output_dir = ".lia/{workflow_type}/{task_name}"

# Required tools (for documentation purposes)
requires_tools = ["file_write", "user_input"]

# Resumability support
resumable = true
checkpoint_interval = "per_phase"

# =============================================================================
# WORKFLOW MODE SYSTEM (Common to all workflows)
# =============================================================================
# 
# All workflows support two distinct modes:
#
# **Collaboration Mode** (Default)
# - Stepwise execution with user approval at each stage
# - Interactive feedback and iterative refinement
# - User control over workflow progression
# - Collaborative decision-making throughout the process
#
# **Silent Mode** (User-Triggered Only)
# - Continuous autonomous execution without user interruption
# - Complete workflow execution from start to finish
# - Assumption-based progression when user input would normally be required
# - All assumptions MUST be recorded in the 0-notepad.md file
# - No user approval requests during workflow execution
#
# Mode Selection: The workflow defaults to Collaboration Mode. 
# Silent Mode must be explicitly requested by the user.

# =============================================================================
# COMMON EXECUTION INSTRUCTIONS
# =============================================================================
#
# These instructions apply to ALL workflows:
#
# - When you want the user to review a document, you MUST use the 'userInput' 
#   tool to ask the user a question
# - You MUST have the user review each phase document before proceeding to the next
# - After each phase completion or revision, you MUST explicitly ask the user 
#   to approve the work using the 'userInput' tool
# - You MUST NOT proceed to the next phase until you receive explicit approval 
#   from the user (a clear "yes", "approved", or equivalent affirmative response)
# - If the user provides feedback, you MUST make the requested modifications 
#   and then explicitly ask for approval again
# - You MUST continue this feedback-revision cycle until the user explicitly 
#   approves the work
# - You MUST follow the workflow steps in sequential order
# - You MUST NOT skip ahead to later steps without completing earlier ones 
#   and receiving explicit user approval
# - You MUST treat each constraint in the workflow as a strict requirement
# - You MUST NOT assume user preferences or requirements - always ask explicitly
# - You MUST maintain a clear record of which step you are currently on
# - You MUST NOT combine multiple steps into a single interaction
# - You MUST ONLY execute one task at a time. Once it is complete, do not move 
#   to the next task automatically

# =============================================================================
# NOTEPAD TEMPLATE
# =============================================================================
#
# Every workflow creates a 0-notepad.md file using this structure:
#
# ```markdown
# # {Workflow Name} Notepad
# **Workflow**: {Workflow Type}  
# **Task**: {task_name}  
# **Created**: {date}
#
# ---
#
# ## üß† Key Insights & Discoveries
# <!-- Unexpected findings, patterns, or "aha moments" -->
#
# ## üîß Technical Notes & Implementation Details  
# <!-- Technical considerations, constraints, implementation details -->
#
# ## üí° Ideas & Future Enhancements
# <!-- Ideas, improvements, enhancement opportunities -->
#
# ## üîó Cross-System Connections
# <!-- Links to other components, related work, architectural insights -->
#
# ## üìù User Notes
# <!-- Space for user to add their own observations -->
#
# ## ü§ñ LLM Observations
# <!-- AI-generated insights about patterns and strategies -->
#
# ---
# *This notepad captures valuable insights that emerge during systematic analysis*
# ```

# =============================================================================
# CONTEXT HANDOFF TEMPLATE
# =============================================================================
#
# Use this template when handing off to another session, spec, or reviewer.
# Save as `handoff.md` in the task directory.
#
# ```markdown
# # Context Handoff Summary
# **From**: {current_workflow} | **To**: {next_workflow or "New Session"}
# **Task**: {task_name}
# **Date**: {date}
#
# ---
#
# ## Task State
# - **Started**: {start_datetime}
# - **Current Phase**: {phase_number} of {total_phases} ({phase_name})
# - **Completion**: ~{percentage}%
# - **Status**: {In Progress | Blocked | Ready for Review | Complete}
#
# ## Key Decisions Made
# 1. {Decision 1 with brief rationale}
# 2. {Decision 2 with brief rationale}
# 3. ...
#
# ## Open Questions / Blockers
# - [ ] {Question or blocker 1}
# - [ ] {Question or blocker 2}
#
# ## Files Modified/Created
# | File | Status | Notes |
# |------|--------|-------|
# | `path/to/file` | New/Modified | Brief description |
#
# ## Next Actions
# 1. {Immediate next step}
# 2. {Following step}
# 3. {Following step}
#
# ## Handoff Type
# - [ ] Continue in new session (same workflow)
# - [ ] Transition to different workflow: `{workflow_name}`
# - [ ] Human review required
# - [ ] Complete - archive context
#
# ## Notes for Next Session
# {Any important context, gotchas, or recommendations}
# ```

# =============================================================================
# SCOPE GUARD (Prevent Over-Engineering)
# =============================================================================
#
# Before implementing any solution, apply the scope check:
#
# ```markdown
# ### Scope Check üîç
# Before proceeding with implementation:
# - [ ] This is the simplest solution that meets requirements
# - [ ] No unnecessary abstractions or indirection
# - [ ] No premature optimisation
# - [ ] No speculative features ("might need later")
# - [ ] A developer new to the project could understand this
#
# **Complexity Assessment**: üü¢ Minimal | üü° Reasonable | üî¥ Over-engineered
#
# **If üî¥ Over-engineered**:
# 1. Document what could be simplified
# 2. Simplify before proceeding
# 3. Record removed complexity in notepad
# ```
#
# Apply scope checks:
# - Before starting implementation phases
# - When adding new abstractions or patterns
# - When solution exceeds original estimate by >50%

# =============================================================================
# SELF-CORRECTION LOOP
# =============================================================================
#
# After each phase output, verify before proceeding:
#
# ```markdown
# ### Verification Checkpoint
# Before moving to next phase:
# - [ ] Output meets stated requirements
# - [ ] No errors or warnings introduced  
# - [ ] Assumptions documented in notepad
# - [ ] Scope check passed
#
# **If verification fails** (max 3 attempts):
# 1. Document the failure reason
# 2. Analyse root cause
# 3. Adjust approach and retry
# 4. After 3 failures ‚Üí escalate to user
# ```

# =============================================================================
# CONFIDENCE SIGNALS
# =============================================================================
#
# At key decision points, indicate confidence level:
#
# ```markdown
# ### Confidence Assessment
# **Decision confidence**: üü¢ High | üü° Medium | üî¥ Low
#
# üü¢ **High**: Clear requirements, proven pattern, minimal uncertainty
# üü° **Medium**: Some assumptions made, edge cases possible, may need revision
# üî¥ **Low**: Significant uncertainty, multiple valid approaches, user review needed
#
# **If üî¥ Low**: Pause and list uncertainties for user review before proceeding.
# ```

# =============================================================================
# ABORT CONDITIONS
# =============================================================================
#
# Immediately stop and consult the user if:
# - üî¥ Circular logic or infinite loop detected
# - üî¥ 3+ consecutive failed correction attempts  
# - üî¥ Scope has grown >50% beyond original estimate
# - üî¥ Security or data safety concern identified
# - üî¥ Missing critical information after 2 clarification attempts
# - üî¥ Conflicting requirements that cannot be resolved
# - üî¥ Task requires capabilities not available

# =============================================================================
# CHECKPOINT MARKERS
# =============================================================================
#
# Use checkpoint markers to enable workflow resumption:
#
# At the end of each phase, record:
# ```markdown
# ---
# [CHECKPOINT: Phase {N} Complete]
# Time: {timestamp}
# Artifacts: {list of files created}
# Next: Phase {N+1} - {phase_name}
# ---
# ```
#
# To resume a workflow:
# 1. Read the notepad and any handoff.md
# 2. Find the last [CHECKPOINT] marker
# 3. Verify artifacts from that checkpoint exist
# 4. Continue from the indicated next phase

# =============================================================================
# DOCUMENT LOCATIONS (Portable paths)
# =============================================================================
#
# Before executing tasks, ensure you have read relevant documents from:
# - ${WORKSPACE}/docs/ or ./docs/ (main documentation folder)
# - ${WORKSPACE}/docs/development/blueprint-1/phase-1/new-implementations/ (recent implementations)
# - Any existing .lia/{workflow}/{task_name}/*.md files for the current task

# =============================================================================
# AGENT MINDSET (Common qualities)
# =============================================================================
#
# As you execute any workflow, embody these qualities:
#
# **Resilience and Adaptability:**
# - Maintain composure when faced with complex or ambiguous problems
# - If initial approaches fail, adapt your strategy and try alternatives
# - View setbacks as learning opportunities
#
# **Comfort in Ambiguity:**
# - Work confidently with incomplete or conflicting information
# - Make reasonable assumptions when necessary and validate them systematically
# - Navigate unclear situations by focusing on what can be determined
#
# **Self-Reliance and Critical Thinking:**
# - Trust your analytical capabilities and systematic approach
# - Make independent decisions based on evidence and logical reasoning
# - Question assumptions and validate information
#
# **Growth Mindset:**
# - Approach each session as an opportunity to enhance skills
# - Learn from every interaction and incorporate new knowledge
# - Maintain curiosity and openness to discovering unexpected solutions
